import"./base-iHJmQtcg.js";/* empty css                     *//* empty css                 */import{Q as w,r as c,y as R,T as $,f as j,c as M,w as f,o as v,b as t,a as m,u as s,i as k,t as b,d as Q,k as V,F as T,z as U}from"./app-JKzr_vVp.js";import q from"./RegisterLayout-B6S9lRBb.js";/* empty css                   */import{E}from"./index-58r0-HTj.js";import{E as z}from"./index-CcXRvPvX.js";import{a as D,E as P}from"./index-DJdM4qGV.js";import"./RegisterLayout.vue_vue_type_style_index_0_lang-D7QsxWgP.js";import"./event-BB_Ol6Sd.js";import"./index-CKck6qGF.js";import"./vnode-B6PzXlGy.js";import"./icon-MSFJ_NKx.js";import"./HelloAnimation-CEXemSgO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-form-common-props-CZDNuDUm.js";import"./get-BNOfz7a2.js";import"./isArray-Dxzbedgu.js";import"./index-Cl32T4Tj.js";import"./typescript-Bp3YSIOJ.js";import"./aria-CHApNzmi.js";import"./index-CL1ggOOL.js";import"./index-CSTan3Pl.js";import"./index-BLed4XWL.js";import"./index-CM0LdUiu.js";import"./castArray-Ce6QuK0j.js";import"./_baseClone-Cky5vQQ9.js";import"./_Uint8Array-CSMkYC73.js";import"./_initCloneObject-32_YsKBG.js";const A={class:"border-card border divide-y rounded-md"},G={class:"px-6 py-4"},H={class:"block mb-2 relative"},J={class:"flex gap-2"},K=["disabled"],L={key:0,class:"text-xs absolute bottom-0 m-auto translate-x-0.5"},O={class:"text-red-500"},W={key:1,class:"text-red-500 text-xs absolute bottom-0 m-auto translate-x-0.5"},X={class:"block mb-2"},Y={class:"flex gap-2"},Be={__name:"RegisterPhone",setup(Z){const g=w().props.register||{},h=w().props.errors.step_message||"",a=c(!1),r=c("");let d=null;const n=c(0);R(()=>{h&&E.error(h)});const o=$({verify_num:g.verify_num||"",phone:g.phone||""}),C=()=>{n.value=60,d&&clearInterval(d),d=setInterval(()=>{n.value>0?n.value--:(a.value=!1,r.value="",clearInterval(d))},1e3)},F=async()=>{!o.verify_num||!o.phone||!await x()||await I()},I=()=>o.post(route("register.post.phone"),{onSuccess:()=>T.visit(route("register.password")),onError:i=>{}}),S=async()=>{if(await x())return await U.post(route("register.sendSmsCode"),{phone:o.phone}).then(e=>{if(e.data.success){a.value=!0,r.value="秒後可再次獲取驗證碼";let u=e.data.sms;N(`您獲取得驗證碼為: ${u}`,"success"),C()}else e.data.error&&(a.value=!1,r.value=e.data.error)}).catch(e=>{var p,l;a.value=!1,r.value=((l=(p=e.response)==null?void 0:p.data)==null?void 0:l.error)||"驗證碼發送失敗"})},_=c(),B=j(()=>({phone:[{required:!0,message:"手機號碼未填寫",trigger:"submit"},{pattern:/^09\d{8}$/,message:"手機號碼格式錯誤",trigger:"submit"}]})),x=async()=>{if(_.value)try{return await _.value.validate(),!0}catch{return!1}},N=(i,e)=>{E({message:i,type:e})};return(i,e)=>{const u=z,y=D,p=P;return v(),M(q,null,{form:f(()=>[t("div",A,[e[2]||(e[2]=t("div",{class:"px-6 py-3"},[t("h1",{class:"text-strong font-medium text-2xl font-bold"}," 手機驗證 ")],-1)),t("div",G,[m(p,{model:s(o),class:"demo-ruleForm",rules:B.value,ref_key:"internalFormRef",ref:_},{default:f(()=>[t("div",null,[t("label",H,[t("div",J,[m(y,{label:"",prop:"phone",class:"relative w-[70%]"},{default:f(()=>[m(u,{modelValue:s(o).phone,"onUpdate:modelValue":e[0]||(e[0]=l=>s(o).phone=l),placeholder:"請輸入手機號碼進行驗證"},null,8,["modelValue"])]),_:1}),t("button",{type:"button",onClick:S,disabled:n.value>0,class:"text-slate-700 bg-transparent inline-flex h-8 w-[30%] justify-center items-center rounded-md border border-gray-300 text-sm font-bold bg-form-hover hover:border-neutral-400 disabled:text-gray-300"}," 取得驗證碼 ",8,K)]),a.value?(v(),k("p",L,[t("span",O,b(n.value),1),Q(" "+b(r.value),1)])):V("",!0),!a.value&&r.value?(v(),k("p",W,b(r.value),1)):V("",!0)]),t("label",X,[t("div",Y,[m(y,{label:"",prop:"verify_num",error:s(o).errors.phone||s(o).errors.verify_num,class:"relative w-full"},{default:f(()=>[m(u,{modelValue:s(o).verify_num,"onUpdate:modelValue":e[1]||(e[1]=l=>s(o).verify_num=l),placeholder:"請輸入驗證碼"},null,8,["modelValue"])]),_:1},8,["error"])])])])]),_:1},8,["model","rules"]),t("button",{type:"button",onClick:F,class:"text-white bg-indigo-400 inline-flex h-8 w-full justify-center items-center rounded-md border border-indigo-300 text-sm font-bold hover:bg-indigo-500 hover:border-indigo-500"}," 下一步 ")])])]),_:1})}}};export{Be as default};
